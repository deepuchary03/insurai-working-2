# Production application properties for Render deployment
server.port=${PORT:8081}

# ===============================
# Database Configuration for Production / Render
# NOTE: H2 is in-memory and only suitable for development/testing.
# For production, set DB_URL/DB_USERNAME/DB_PASSWORD in the environment
# and use an external managed database. This file uses H2 as a default
# to avoid connection issues when no external DB is provided.
# ===============================
# Use external DB if provided via DB_URL, otherwise fallback to H2 in-memory
spring.datasource.url=${DB_URL:jdbc:h2:mem:insurancedb;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE}
spring.datasource.driver-class-name=${DB_DRIVER:org.h2.Driver}
spring.datasource.username=${DB_USERNAME:sa}
spring.datasource.password=${DB_PASSWORD:}
spring.h2.console.settings.web-allow-others=true
spring.h2.console.enabled=true
spring.h2.console.path=/h2-console


# ===============================
# JPA / Hibernate Configuration
# ===============================
spring.jpa.database-platform=${JPA_DIALECT:org.hibernate.dialect.H2Dialect}
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false
spring.jpa.hibernate.naming.physical-strategy=org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl
# Explicitly set the Hibernate dialect to H2 to prevent generation of MySQL-specific DDL
spring.jpa.properties.hibernate.dialect=${JPA_DIALECT:org.hibernate.dialect.H2Dialect}

# ===============================
# Spring Security
# ===============================
spring.security.user.name=${ADMIN_USERNAME:admin}
spring.security.user.password=${ADMIN_PASSWORD:admin123}

# ===============================
# Actuator Configuration for Health Checks
# ===============================
management.endpoint.health.show-details=when_authorized
management.health.db.enabled=true

# Expose actuator endpoints (default to health,info) - can be overridden with MANAGEMENT_ENDPOINTS
management.endpoints.web.exposure.include=${MANAGEMENT_ENDPOINTS:health,info}

# ===============================
# Logging for production
# ===============================
logging.level.org.hibernate.SQL=WARN
logging.level.com.insurance.app=INFO
logging.level.root=INFO